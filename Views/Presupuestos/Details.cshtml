@model Models.Presupuesto
@{
    ViewData["Title"] = $"Presupuesto #{Model.IdPresupuesto}";
}

<h1 class="mb-3">Presupuesto #@Model.IdPresupuesto</h1>

<div class="card mb-4">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3">Destinatario</dt>
            <dd class="col-sm-9">@Model.NombreDestinatario</dd>

            <dt class="col-sm-3">Fecha</dt>
            <dd class="col-sm-9">@Model.FechaCreacion.ToString("yyyy-MM-dd")</dd>

            <dt class="col-sm-3">Cantidad de productos</dt>
            <dd class="col-sm-9">@Model.CantidadProductos()</dd>

            <dt class="col-sm-3">Monto (sin IVA)</dt>
            <dd class="col-sm-9">@Model.MontoPresupuesto()</dd>

            <dt class="col-sm-3">Monto (con IVA 21%)</dt>
            <dd class="col-sm-9">@Model.MontoPresupuestoConIva()</dd>
        </dl>
    </div>
</div>

<h4>Productos</h4>
@if (Model.Detalle == null || Model.Detalle.Count == 0)
{
    <div class="alert alert-info">Este presupuesto no tiene productos asociados.</div>
}
else
{
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Producto</th>
                <th class="text-end">Precio</th>
                <th class="text-end">Cantidad</th>
                <th class="text-end">Subtotal</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var d in Model.Detalle)
        {
            var subtotal = d.Producto.Precio * d.Cantidad;
            <tr>
                <td>@d.Producto.Descripcion</td>
                <td class="text-end">@d.Producto.Precio</td>
                <td class="text-end">@d.Cantidad</td>
                <td class="text-end">@subtotal</td>
            </tr>
        }
        </tbody>
    </table>
}

<a class="btn btn-primary me-2" asp-action="AgregarProducto" asp-route-id="@Model.IdPresupuesto">Agregar producto</a>
<a class="btn btn-secondary" asp-action="Index">Volver</a>
